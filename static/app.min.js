/*

  NYU CTIP Web
  @author David Tsai
*/
function x(c){for(;2>c.length;)c="0"+c;return c}function H(c,d){var b,e=c.length-d+1,h=[];for(b=0;b<e;++b)h.push(c.slice(b,b+d));return h}function K(){this.b=[];this.c=""}function L(c,d,b){(c.b.length&1)==b?c.b.length?c.b.push(c.b.pop()+d):(c.b.push(""),c.b.push(d)):c.b.push(d)}function M(){this.a=[]}
M.prototype.get=function(c){for(var d,b,e,h,k=[],u={0:!0};;){e=-1;h="";for(b in u)u.hasOwnProperty(b)&&(d=parseInt(b,36),this.a[d][0]>=h&&(h=this.a[d][0],e=d));if(0>e)break;delete u[e.toString(36)];if(this.a[e][0]>=c){if(h.substr(0,c.length)==c)k.push(this.a[e]);else if(k.length)break;d=2*e+1;e=d+1;d<this.a.length&&(u[d.toString(36)]=!0);e<this.a.length&&(u[e.toString(36)]=!0)}}return k};
function P(c,d,b){if(!c.a.length)return null;if(c.a[b][0]==d)return c.a[b][1];if(c.a[b][0]>d&&(b=2*b+1,b<c.a.length)){var e=P(c,d,b);if(null!==e)return e;b+=1;if(b<c.a.length&&(e=P(c,d,b),null!==e))return e}return null}
function Q(){function c(){B||C()}function d(a){var b=a.target||a.srcElement;b!=y&&(D="",y=b);if(b.value.length&&b.value!=D){z.innerHTML="";E={};for(a=0;a<F.length;++a)F[a](b,e);D=b.value}}function b(a){switch(a.key){case "Tab":case "Enter":"none"!=t.style.display&&(a.preventDefault(),m(A()));break;case "Esc":case "Escape":a.preventDefault();C();break;case "Down":case "ArrowDown":a.preventDefault();a:{if(a=A()){if(a.nextElementSibling){a=a.nextElementSibling;break a}if(a.parentElement.parentElement.nextElementSibling&&
(a=a.parentElement.parentElement.nextElementSibling.getElementsByTagName("li"),a.length)){a=a[0];break a}}a=null}I(a,!0);break;case "Up":case "ArrowUp":a.preventDefault();a:{if(a=A()){if(a.previousElementSibling){a=a.previousElementSibling;break a}if(a.parentElement.parentElement.previousElementSibling&&(a=a.parentElement.parentElement.previousElementSibling.getElementsByTagName("li"),a.length)){a=a[a.length-1];break a}}a=null}I(a,!0)}}function e(a,b){var c;t.style.display="";J();if(E.hasOwnProperty(a))var d=
E[a];else{var e=document.createElement("li");d=document.createElement("ul");var g=document.createElement("div");g.textContent=a;g.className="autocomplete-suggestions-heading";e.appendChild(g);e.appendChild(d);z.appendChild(e);E[a]=d}for(e=0;e<b.length;++e){g=document.createElement("li");h(g);var m=document.createElement("div");for(c=0;c<b[e].b.length;++c)if(b[e].b[c].length){var f=document.createElement("span");c&1||(f.className="autocomplete-suggestions-match");f.textContent=b[e].b[c];m.appendChild(f)}g.appendChild(m);
b[e].c.length&&(c=document.createElement("div"),c.textContent=b[e].c,g.appendChild(c));d.appendChild(g)}A()||(d=z.getElementsByTagName("ul"),d.length&&d[0].firstElementChild&&(d[0].firstElementChild.className="autocomplete-suggestions-selection"))}function h(a){a.addEventListener("mousedown",u);a.addEventListener("touchstart",u);a.addEventListener("click",function(){B=!1;m(a)});a.addEventListener("mouseover",function(){I(a,!1)})}function k(){B=!1}function u(){B=!0}function m(a){a&&(y.value=D=a.firstElementChild.textContent,
C(),y.focus())}function I(a,b){if(a){var c=A();c&&(c.className="");a.className="autocomplete-suggestions-selection";b&&(a.previousElementSibling?a.scrollIntoView(N):a.parentElement.parentElement.scrollIntoView(N))}}function A(){var a=z.getElementsByClassName("autocomplete-suggestions-selection");return a.length?a[0]:null}function C(){t.style.display="none"}function J(){if("none"!=t.style.display){t.style.maxHeight=Math.max(document.documentElement.clientHeight,window.innerHeight||0)-t.getBoundingClientRect().top-
12+"px";var a=y.getBoundingClientRect();t.style.top=a.bottom+pageYOffset+"px";t.style.left=a.left+pageXOffset+"px"}}var w,E,N={behavior:"smooth",block:"nearest",inline:"nearest"},O=document.getElementById("google_maps_api_key"),G=document.createElement("script"),t=document.createElement("div"),z=document.createElement("ul"),F=[],y=null,D="",B=!1,l=document.getElementsByClassName("text-location");for(w=0;w<l.length;++w)l[w].addEventListener("keydown",b),l[w].addEventListener("keyup",d),l[w].addEventListener("focus",
k),l[w].addEventListener("blur",c),l[w].autocomplete="off";addEventListener("resize",J);addEventListener("scroll",J);t.appendChild(z);t.id="autocomplete-suggestions";t.style.position="absolute";C();document.body.appendChild(t);O&&(window.googleCallback=function(){var a=window.google.maps,b=a.places,c=new a.LatLng(40.72797042,-73.98642518),d=new b.AutocompleteService;F.push(function(a,b){d.getPlacePredictions({input:a.value,offset:a.selectionStart,location:c,radius:4500},function(a,c){if("OK"==c){var d,
e,f,g=[];for(d=0;d<a.length;++d){var m=a[d].structured_formatting;var q=m.main_text;var r=m.main_text_matched_substrings;var n=new K;for(e=f=0;e<r.length;++e){var p=r[e].offset;var h=r[e].length;f<p&&L(n,q.substring(f,p),!1);L(n,q.substr(p,h),!0);f=p+h}f<q.length&&L(n,q.substr(f),!1);n.c=m.secondary_text||"";g.push(n)}b("From Google Maps",g)}})})},G.src="https://maps.googleapis.com/maps/api/js?key="+encodeURIComponent(O.value)+"&libraries=places&callback=googleCallback",G.async=!0,G.defer=!0,document.body.appendChild(G));
(function(){function a(a){var b,f=a.getElementsByTagName("option");var m={};c[a]=m;for(a=0;a<f.length;++a){var v=f[a].getAttribute("data-category")||"Miscellaneous";if(m.hasOwnProperty(v))var h=m[v];else h=new M,m[v]=h;if(b=f[a].value.toLowerCase().match(e)){var g=[];for(v=1;v<=b.length;++v)g=g.concat(H(b,v));b=g;for(v=0;v<b.length;++v){var k=b[v].join(" ");g=P(h,k,0);if(null===g){g=[];for(var q,r=h,n=k,p=r.a.push([n,g])-1;0<p;){q=Math.floor((p-1)/2);if(r.a[q][0]>n)break;k=r.a[q];r.a[q]=r.a[p];r.a[p]=
k;p=q}}0>g.indexOf(f[a].value)&&g.push(f[a].value)}}d[f[a].value]=f[a].value.toLowerCase()}}var b,c={},d={},e=/[\w'\u2019]+/g;for(b=0;b<l.length;++b)l[b].list&&(c.hasOwnProperty(l[b].list)||a(l[b].list),l[b].f=l[b].list,l[b].removeAttribute("list"));F.push(function(a,b){var f,m,h,g;if(c.hasOwnProperty(a.f)){var k=c[a.f];for(m in k)if(k.hasOwnProperty(m)){var l=k[m];var q=[];var r={};if(g=a.value.match(e)){for(f=0;f<g.length;++f)g[f]=g[f].toLowerCase();g=g.join(" ")}else g="";var n=l.get(g);for(f=
0;f<n.length;++f)for(l=0;l<n[f][1].length;++l)r[n[f][1][l]]=!0;for(h in r)if(!0===r[h]){f=new K;l=d[h];for(n=0;n<h.length;){var p=l.indexOf(g,n);if(0>p){L(f,h.substr(n),!1);break}n<p&&L(f,h.substring(n,p),!1);L(f,h.substr(p,g.length),!0);n=p+g.length}q.push(f)}q.length&&b(m,q)}}})})()}
window.addEventListener("load",function(){function c(b){d.value=b.coords.latitude+","+b.coords.longitude}var d;var b=document.getElementById("place-footer");var e=document.getElementById("use-now");if(b&&(d=document.getElementById("text-orig"))){var h=document.getElementById("text-dest");if(navigator.geolocation){var k=document.createElement("button");k.textContent="Use Current Location as Origin";k.addEventListener("click",function(b){b.preventDefault();navigator.geolocation.getCurrentPosition(c)});
b.appendChild(k)}h&&(k=document.createElement("button"),k.textContent="Reverse",k.addEventListener("click",function(b){b.preventDefault();b=d.value;d.value=h.value;h.value=b}),b.appendChild(k))}if(e){var u=document.getElementById("select_day");b=document.getElementById("time_when");u&&b&&(b=document.createElement("button"),b.textContent="Now",b.addEventListener("click",function(b){b.preventDefault();b=new Date;var c=u.parentElement.getElementsByClassName("select-items");c?c[0].children[Math.min(b.getDay(),
c[0].children.length-1)].click():select_day.children[b.getDay()].selected=!0;time_when.value=x(b.getHours().toString())+":"+x(b.getMinutes().toString())}),e.appendChild(b))}Q()});