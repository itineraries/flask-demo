/*

  NYU CTIP Web
  @author David Tsai
*/
function x(c){for(;2>c.length;)c="0"+c;return c}function H(c,d){var a,e=c.length-d+1,h=[];for(a=0;a<e;++a)h.push(c.slice(a,a+d));return h}function K(){this.b=[];this.c=""}function L(c,d,a){(c.b.length&1)==a?c.b.length?c.b.push(c.b.pop()+d):(c.b.push(""),c.b.push(d)):c.b.push(d)}function M(){this.a=[]}
M.prototype.get=function(c){for(var d,a,e,h,k=[],u={0:!0};;){e=-1;h="";for(a in u)u.hasOwnProperty(a)&&(d=parseInt(a,36),this.a[d][0]>=h&&(h=this.a[d][0],e=d));if(0>e)break;delete u[e.toString(36)];if(this.a[e][0]>=c){if(h.substr(0,c.length)==c)k.push(this.a[e]);else if(k.length)break;d=2*e+1;e=d+1;d<this.a.length&&(u[d.toString(36)]=!0);e<this.a.length&&(u[e.toString(36)]=!0)}}return k};
function Q(c,d,a){if(!c.a.length)return null;if(c.a[a][0]==d)return c.a[a][1];if(c.a[a][0]>d&&(a=2*a+1,a<c.a.length)){var e=Q(c,d,a);if(null!==e)return e;a+=1;if(a<c.a.length&&(e=Q(c,d,a),null!==e))return e}return null}
function R(){function c(){B||C()}function d(b){var a=b.target||b.srcElement;a!=y&&(D="",y=a);if(a.value.length&&a.value!=D){z.innerHTML="";E={};for(b=0;b<F.length;++b)F[b](a,e);D=a.value}}function a(b){switch(b.key){case "Tab":case "Enter":"none"!=t.style.display&&(b.preventDefault(),n(A()));break;case "Esc":case "Escape":b.preventDefault();C();break;case "Down":case "ArrowDown":b.preventDefault();a:{if(b=A()){if(b.nextElementSibling){b=b.nextElementSibling;break a}if(b.parentElement.parentElement.nextElementSibling&&
(b=b.parentElement.parentElement.nextElementSibling.getElementsByTagName("li"),b.length)){b=b[0];break a}}b=null}I(b,!0);break;case "Up":case "ArrowUp":b.preventDefault();a:{if(b=A()){if(b.previousElementSibling){b=b.previousElementSibling;break a}if(b.parentElement.parentElement.previousElementSibling&&(b=b.parentElement.parentElement.previousElementSibling.getElementsByTagName("li"),b.length)){b=b[b.length-1];break a}}b=null}I(b,!0)}}function e(b,a){var c;t.style.display="";J();if(E.hasOwnProperty(b))var d=
E[b];else{var e=document.createElement("li");d=document.createElement("ul");var g=document.createElement("div");g.textContent=b;g.className="autocomplete-suggestions-heading";e.appendChild(g);e.appendChild(d);z.appendChild(e);E[b]=d}for(e=0;e<a.length;++e){g=document.createElement("li");h(g);var N=document.createElement("div");for(c=0;c<a[e].b.length;++c)if(a[e].b[c].length){var f=document.createElement("span");c&1||(f.className="autocomplete-suggestions-match");f.textContent=a[e].b[c];N.appendChild(f)}g.appendChild(N);
a[e].c.length&&(c=document.createElement("div"),c.textContent=a[e].c,g.appendChild(c));d.appendChild(g)}A()||(d=z.getElementsByTagName("ul"),d.length&&d[0].firstElementChild&&(d[0].firstElementChild.className="autocomplete-suggestions-selection"))}function h(b){b.addEventListener("mousedown",u);b.addEventListener("touchstart",u);b.addEventListener("click",function(){B=!1;n(b)});b.addEventListener("mouseover",function(){I(b,!1)})}function k(){B=!1}function u(){B=!0}function n(b){if(b){var a,c=[];for(a=
0;a<b.children.length;++a)c.push(b.children[a].textContent);y.value=D=c.join(", ");C();y.focus()}}function I(b,a){if(b){var c=A();c&&(c.className="");b.className="autocomplete-suggestions-selection";a&&(b.previousElementSibling?b.scrollIntoView(O):b.parentElement.parentElement.scrollIntoView(O))}}function A(){var b=z.getElementsByClassName("autocomplete-suggestions-selection");return b.length?b[0]:null}function C(){t.style.display="none"}function J(){if("none"!=t.style.display){t.style.maxHeight=
Math.max(document.documentElement.clientHeight,window.innerHeight||0)-t.getBoundingClientRect().top-12+"px";var b=y.getBoundingClientRect();t.style.top=b.bottom+pageYOffset+"px";t.style.left=b.left+pageXOffset+"px"}}var w,E,O={behavior:"smooth",block:"nearest",inline:"nearest"},P=document.getElementById("google_maps_api_key"),G=document.createElement("script"),t=document.createElement("div"),z=document.createElement("ul"),F=[],y=null,D="",B=!1,l=document.getElementsByClassName("text-location");for(w=
0;w<l.length;++w)l[w].addEventListener("keydown",a),l[w].addEventListener("keyup",d),l[w].addEventListener("focus",k),l[w].addEventListener("blur",c),l[w].autocomplete="off";addEventListener("resize",J);addEventListener("scroll",J);t.appendChild(z);t.id="autocomplete-suggestions";t.style.position="absolute";C();document.body.appendChild(t);P&&(window.googleCallback=function(){var b=window.google.maps,a=b.places,c=new b.LatLng(40.72797042,-73.98642518),d=new a.AutocompleteService;F.push(function(b,
a){d.getPlacePredictions({input:b.value,offset:b.selectionStart,location:c,radius:4500},function(b,c){if("OK"==c){var d,e,f,g=[];for(d=0;d<b.length;++d){var n=b[d].structured_formatting;var q=n.main_text;var r=n.main_text_matched_substrings;var m=new K;for(e=f=0;e<r.length;++e){var p=r[e].offset;var h=r[e].length;f<p&&L(m,q.substring(f,p),!1);L(m,q.substr(p,h),!0);f=p+h}f<q.length&&L(m,q.substr(f),!1);m.c=n.secondary_text||"";g.push(m)}a("From Google Maps",g)}})})},G.src="https://maps.googleapis.com/maps/api/js?key="+
encodeURIComponent(P.value)+"&libraries=places&callback=googleCallback",G.async=!0,G.defer=!0,document.body.appendChild(G));(function(){function b(b){var a,f=b.getElementsByTagName("option");var n={};c[b]=n;for(b=0;b<f.length;++b){var v=f[b].getAttribute("data-category")||"Miscellaneous";if(n.hasOwnProperty(v))var h=n[v];else h=new M,n[v]=h;if(a=f[b].value.toLowerCase().match(e)){var g=[];for(v=1;v<=a.length;++v)g=g.concat(H(a,v));a=g;for(v=0;v<a.length;++v){var k=a[v].join(" ");g=Q(h,k,0);if(null===
g){g=[];for(var q,r=h,m=k,p=r.a.push([m,g])-1;0<p;){q=Math.floor((p-1)/2);if(r.a[q][0]>m)break;k=r.a[q];r.a[q]=r.a[p];r.a[p]=k;p=q}}0>g.indexOf(f[b].value)&&g.push(f[b].value)}}d[f[b].value]=f[b].value.toLowerCase()}}var a,c={},d={},e=/[\w'\u2019]+/g;for(a=0;a<l.length;++a)l[a].list&&(c.hasOwnProperty(l[a].list)||b(l[a].list),l[a].f=l[a].list,l[a].removeAttribute("list"));F.push(function(b,a){var f,n,h,g;if(c.hasOwnProperty(b.f)){var k=c[b.f];for(n in k)if(k.hasOwnProperty(n)){var l=k[n];var q=[];
var r={};if(g=b.value.match(e)){for(f=0;f<g.length;++f)g[f]=g[f].toLowerCase();g=g.join(" ")}else g="";var m=l.get(g);for(f=0;f<m.length;++f)for(l=0;l<m[f][1].length;++l)r[m[f][1][l]]=!0;for(h in r)if(!0===r[h]){f=new K;l=d[h];for(m=0;m<h.length;){var p=l.indexOf(g,m);if(0>p){L(f,h.substr(m),!1);break}m<p&&L(f,h.substring(m,p),!1);L(f,h.substr(p,g.length),!0);m=p+g.length}q.push(f)}q.length&&a(n,q)}}})})()}
window.addEventListener("load",function(){function c(a){d.value=a.coords.latitude+","+a.coords.longitude}var d;var a=document.getElementById("place-footer");var e=document.getElementById("use-now");if(a&&(d=document.getElementById("text-orig"))){var h=document.getElementById("text-dest");if(navigator.geolocation){var k=document.createElement("button");k.textContent="Use Current Location as Origin";k.addEventListener("click",function(a){a.preventDefault();navigator.geolocation.getCurrentPosition(c)});
a.appendChild(k)}h&&(k=document.createElement("button"),k.textContent="Reverse",k.addEventListener("click",function(a){a.preventDefault();a=d.value;d.value=h.value;h.value=a}),a.appendChild(k))}if(e){var u=document.getElementById("select_day");a=document.getElementById("time_when");u&&a&&(a=document.createElement("button"),a.textContent="Now",a.addEventListener("click",function(a){a.preventDefault();a=new Date;var c=u.parentElement.getElementsByClassName("select-items");c.length?c[0].children[Math.min(a.getDay(),
c[0].children.length-1)].click():select_day.children[a.getDay()].selected=!0;time_when.value=x(a.getHours().toString())+":"+x(a.getMinutes().toString())}),e.appendChild(a))}R()});