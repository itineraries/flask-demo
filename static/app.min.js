/*

  NYU CTIP Web
  @author David Tsai
*/
function v(c){for(;2>c.length;)c="0"+c;return c}function F(c,d){var a,e=c.length-d+1,h=[];for(a=0;a<e;++a)h.push(c.slice(a,a+d));return h}function I(){this.b=[];this.c=""}function J(c,d,a){(c.b.length&1)==a?c.b.length?c.b.push(c.b.pop()+d):(c.b.push(""),c.b.push(d)):c.b.push(d)}function K(){this.a=[]}
K.prototype.get=function(c){for(var d,a,e,h,m=[],t={0:!0};;){e=-1;h="";for(a in t)t.hasOwnProperty(a)&&(d=parseInt(a,36),this.a[d][0]>=h&&(h=this.a[d][0],e=d));if(0>e)break;delete t[e.toString(36)];if(this.a[e][0]>=c){if(h.substr(0,c.length)==c)m.push(this.a[e]);else if(m.length)break;d=2*e+1;e=d+1;d<this.a.length&&(t[d.toString(36)]=!0);e<this.a.length&&(t[e.toString(36)]=!0)}}return m};
function O(c,d,a){if(!c.a.length)return null;if(c.a[a][0]==d)return c.a[a][1];if(c.a[a][0]>d&&(a=2*a+1,a<c.a.length)){var e=O(c,d,a);if(null!==e)return e;a+=1;if(a<c.a.length&&(e=O(c,d,a),null!==e))return e}return null}
function P(){function c(){z||A()}function d(b){var a=b.target||b.srcElement;a!=w&&(B="",w=a);if(a.value.length&&a.value!=B){x.innerHTML="";C={};for(b=0;b<D.length;++b)D[b](a,e);B=a.value}}function a(b){switch(b.key){case "Tab":case "Enter":"none"!=f.style.display&&(b.preventDefault(),n(y()));break;case "Esc":case "Escape":b.preventDefault();A();break;case "Down":case "ArrowDown":b.preventDefault();a:{if(b=y()){if(b.nextElementSibling){b=b.nextElementSibling;break a}if(b.parentElement.parentElement.nextElementSibling&&
(b=b.parentElement.parentElement.nextElementSibling.getElementsByTagName("li"),b.length)){b=b[0];break a}}b=null}G(b,!0);break;case "Up":case "ArrowUp":b.preventDefault();a:{if(b=y()){if(b.previousElementSibling){b=b.previousElementSibling;break a}if(b.parentElement.parentElement.previousElementSibling&&(b=b.parentElement.parentElement.previousElementSibling.getElementsByTagName("li"),b.length)){b=b[b.length-1];break a}}b=null}G(b,!0)}}function e(b,a){var c;f.style.display="";H();if(C.hasOwnProperty(b))var d=
C[b];else{var e=document.createElement("li");d=document.createElement("ul");var l=document.createElement("div");l.textContent=b;l.className="autocomplete-suggestions-heading";e.appendChild(l);e.appendChild(d);x.appendChild(e);C[b]=d}for(e=0;e<a.length;++e){l=document.createElement("li");h(l);var L=document.createElement("div");for(c=0;c<a[e].b.length;++c)if(a[e].b[c].length){var g=document.createElement("span");c&1||(g.className="autocomplete-suggestions-match");g.textContent=a[e].b[c];L.appendChild(g)}l.appendChild(L);
a[e].c.length&&(c=document.createElement("div"),c.textContent=a[e].c,l.appendChild(c));d.appendChild(l)}y()||(d=x.getElementsByTagName("ul"),d.length&&d[0].firstElementChild&&(d[0].firstElementChild.className="autocomplete-suggestions-selection"))}function h(b){b.addEventListener("mousedown",t);b.addEventListener("touchstart",t);b.addEventListener("click",function(){z=!1;n(b)});b.addEventListener("mouseover",function(){G(b,!1)})}function m(){z=!1}function t(){z=!0}function n(b){if(b){var a,c=[];for(a=
0;a<b.children.length;++a)c.push(b.children[a].textContent);w.value=B=c.join(", ");A();w.focus()}}function G(b,a){if(b){var c=y();c&&(c.className="");b.className="autocomplete-suggestions-selection";a&&(b.previousElementSibling?b.scrollIntoView(M):b.parentElement.parentElement.scrollIntoView(M))}}function y(){var b=x.getElementsByClassName("autocomplete-suggestions-selection");return b.length?b[0]:null}function A(){f.style.display="none"}function H(){if("none"!=f.style.display){var b=w.getBoundingClientRect(),
a=getComputedStyle(w),c=getComputedStyle(f);f.style.maxHeight=Math.max(document.documentElement.clientHeight,window.innerHeight||0)-f.getBoundingClientRect().top-12+"px";f.style.width=b.right-b.left-parseFloat(c.borderLeftWidth)-parseFloat(c.borderRightWidth)+"px";f.style.top=b.bottom+pageYOffset-parseFloat(a.borderBottomWidth)+"px";f.style.left=b.left+pageXOffset+"px"}}var u,C,M={behavior:"smooth",block:"nearest",inline:"nearest"},N=document.getElementById("google_maps_api_key"),E=document.createElement("script"),
f=document.createElement("div"),x=document.createElement("ul"),D=[],w=null,B="",z=!1,k=document.getElementsByClassName("text-location");for(u=0;u<k.length;++u)k[u].addEventListener("keydown",a),k[u].addEventListener("keyup",d),k[u].addEventListener("focus",m),k[u].addEventListener("blur",c),k[u].autocomplete="off";addEventListener("resize",H);addEventListener("scroll",H);f.appendChild(x);f.id="autocomplete-suggestions";f.style.position="absolute";A();document.body.appendChild(f);N&&(window.googleCallback=
function(){var b=window.google.maps,a=b.places,c=new b.LatLng(40.72797042,-73.98642518),d=new a.AutocompleteService;D.push(function(b,a){d.getPlacePredictions({input:b.value,offset:b.selectionStart,location:c,radius:4500},function(b,c){if("OK"==c){var d,e,g,l=[];for(d=0;d<b.length;++d){var n=b[d].structured_formatting;var f=n.main_text;var r=n.main_text_matched_substrings;var p=new I;for(e=g=0;e<r.length;++e){var q=r[e].offset;var h=r[e].length;g<q&&J(p,f.substring(g,q),!1);J(p,f.substr(q,h),!0);
g=q+h}g<f.length&&J(p,f.substr(g),!1);p.c=n.secondary_text||"";l.push(p)}a("From Google Maps",l)}})})},E.src="https://maps.googleapis.com/maps/api/js?key="+encodeURIComponent(N.value)+"&libraries=places&callback=googleCallback",E.async=!0,E.defer=!0,document.body.appendChild(E));(function(){function b(b){var a,g=b.getElementsByTagName("option");var n={};c[b]=n;for(b=0;b<g.length;++b){var f=g[b].getAttribute("data-category")||"Miscellaneous";if(n.hasOwnProperty(f))var h=n[f];else h=new K,n[f]=h;if(a=
g[b].value.toLowerCase().match(e)){var l=[];for(f=1;f<=a.length;++f)l=l.concat(F(a,f));a=l;for(f=0;f<a.length;++f){var m=a[f].join(" ");l=O(h,m,0);if(null===l){l=[];for(var k,r=h,p=m,q=r.a.push([p,l])-1;0<q;){k=Math.floor((q-1)/2);if(r.a[k][0]>p)break;m=r.a[k];r.a[k]=r.a[q];r.a[q]=m;q=k}}0>l.indexOf(g[b].value)&&l.push(g[b].value)}}d[g[b].value]=g[b].value.toLowerCase()}}var a,c={},d={},e=/[\w'\u2019]+/g;for(a=0;a<k.length;++a)k[a].list&&(c.hasOwnProperty(k[a].list)||b(k[a].list),k[a].f=k[a].list,
k[a].removeAttribute("list"));D.push(function(b,a){var g,f,n,h;if(c.hasOwnProperty(b.f)){var l=c[b.f];for(f in l)if(l.hasOwnProperty(f)){var k=l[f];var m=[];var r={};if(h=b.value.match(e)){for(g=0;g<h.length;++g)h[g]=h[g].toLowerCase();h=h.join(" ")}else h="";var p=k.get(h);for(g=0;g<p.length;++g)for(k=0;k<p[g][1].length;++k)r[p[g][1][k]]=!0;for(n in r)if(!0===r[n]){g=new I;k=d[n];for(p=0;p<n.length;){var q=k.indexOf(h,p);if(0>q){J(g,n.substr(p),!1);break}p<q&&J(g,n.substring(p,q),!1);J(g,n.substr(q,
h.length),!0);p=q+h.length}m.push(g)}m.length&&a(f,m)}}})})()}
window.addEventListener("load",function(){function c(a){d.value=a.coords.latitude+","+a.coords.longitude}var d;var a=document.getElementById("place-footer");var e=document.getElementById("use-now");if(a&&(d=document.getElementById("text-orig"))){var h=document.getElementById("text-dest");if(navigator.geolocation){var m=document.createElement("button");m.textContent="Use Current Location as Origin";m.addEventListener("click",function(a){a.preventDefault();navigator.geolocation.getCurrentPosition(c)});
a.appendChild(m)}h&&(m=document.createElement("button"),m.textContent="Reverse",m.addEventListener("click",function(a){a.preventDefault();a=d.value;d.value=h.value;h.value=a}),a.appendChild(m))}if(e){var t=document.getElementById("select_day");a=document.getElementById("time_when");t&&a&&(a=document.createElement("button"),a.textContent="Now",a.addEventListener("click",function(a){a.preventDefault();a=new Date;var c=t.parentElement.getElementsByClassName("select-items");c.length?c[0].children[Math.min(a.getDay(),
c[0].children.length-1)].click():select_day.children[a.getDay()].selected=!0;time_when.value=v(a.getHours().toString())+":"+v(a.getMinutes().toString())}),e.appendChild(a))}P()});